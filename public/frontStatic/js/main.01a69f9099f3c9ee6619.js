webpackJsonp([1],{0:function(t,e,n){n("briU"),t.exports=n("NHnr")},"3ntp":function(t,e){},"4f9f":function(t,e){},"5gk/":function(t,e){},"6WFI":function(t,e){},"8Fkr":function(t,e){},C2xL:function(t,e){},D9hl:function(t,e){},FhoZ:function(t,e,n){"use strict";(function(e){const i=n("z0pV");t.exports={dev:{assetsSubDirectory:"static",assetsPublicPath:"/",proxyTable:{"/community_manage":{target:"http://magix.xyz:3000",changeOrigin:!0}},host:"0.0.0.0",port:8080,autoOpenBrowser:!1,errorOverlay:!0,notifyOnErrors:!0,poll:!1,mock:!1,devtool:"cheap-module-eval-source-map",cacheBusting:!0,cssSourceMap:!0},build:{index:i.resolve(e,"../dist/index.html"),assetsRoot:i.resolve(e,"../dist"),assetsSubDirectory:"frontStatic",assetsPublicPath:"./",productionSourceMap:!0,devtool:"#source-map",productionGzip:!1,productionGzipExtensions:["js","css"],bundleAnalyzerReport:Object({NODE_ENV:"production"}).npm_config_report}}}).call(e,"/")},FxfD:function(t,e){},LSqC:function(t,e){},NDR3:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("8Fkr");var i=n("DbeI"),o=n.n(i),a=n("HsqT"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("keep-alive",[this.$route.meta.keepAlive?e("router-view"):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():e("router-view")],1)},staticRenderFns:[]};var r=n("C7Lr")({name:"App"},s,!1,function(t){n("ayj4")},null,null).exports,l=n("KGCO"),u={login:"/community_manage/user/admin_login",signout:"community_manage/user/signout",signin:"community_manage/user/create",getUser:"community_manage/user/search",checkUser:"community_manage/user/check",changeAuth:"community_manage/user/changeAuth",update:"community_manage/user/update",resetPassword:"/community_manage/user/reset_pass",deleteUser:"/community_manage/user/delete",saveNews:"community_manage/news/save",searchNews:"community_manage/news/search",deleteNews:"community_manage/news/delete",saveHouse:"community_manage/house/save",getList:"community_manage/house/list",deleteHouse:"community_manage/house/delete",upload:"community_manage/upload/binary",fixList:"community_manage/fix/list",deleteFix:"community_manage/fix/delete",saveFix:"/community_manage/fix/save"},c={name:"login",data:function(){return{loginForm:{username:"",password:""},rules:{username:[{validator:function(t,e,n){""===e?n(new Error("请输入用户名")):n()},trigger:"blur"}],password:[{validator:function(t,e,n){""===e?n(new Error("请输入密码")):n()},trigger:"blur"}]}}},created:function(){},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.$post(u.login,{username:e.loginForm.username,password:e.loginForm.password}).then(function(t){e.$store.commit("admin/updateUser",t),e.$router.push("/home")}).catch(function(t){e.$message(t.message)})})}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login"},[n("el-card",{staticClass:"login__loginbox",attrs:{shadow:"hover"}},[n("header",{attrs:{slot:"header"},slot:"header"},[t._v("\n      后台管理系统\n    ")]),t._v(" "),n("el-form",{ref:"loginForm",staticClass:"login__loginform",attrs:{model:t.loginForm,"status-icon":"",rules:t.rules}},[n("el-form-item",{attrs:{prop:"username"}},[n("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}},[n("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("账号")])])],1),t._v(" "),n("el-form-item",{attrs:{prop:"password"}},[n("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}},[n("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("密码")])])],1),t._v(" "),n("router-link",{staticClass:"login__signup",attrs:{to:"signin"}},[t._v("注册新用户")]),t._v(" "),n("el-button",{staticClass:"login__loginbtn",attrs:{type:"primary"},on:{click:function(e){return t.submitForm("loginForm")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var d=n("C7Lr")(c,m,!1,function(t){n("NDR3")},null,null).exports,f={name:"signin",data:function(){var t=this;return{signinForm:{username:"",password:"",pass:"",address:""},rules:{username:[{validator:function(t,e,n){""===e?n(new Error("请输入用户名")):n()},trigger:"blur"}],password:[{validator:function(t,e,n){""===e?n(new Error("请输入密码")):n()},trigger:"blur"}],pass:[{validator:function(e,n,i){""===n?i(new Error("请输入密码")):t.signinForm.password===t.signinForm.pass?(console.log(t.pass),i()):i(new Error("两次输入密码不一致"))},trigger:"blur"}],address:[{validator:function(t,e,n){""===e?n(new Error("请输入住址")):n()},trigger:"blur"}]}}},created:function(){},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.$post(u.signin,{username:e.signinForm.username,password:e.signinForm.password,pass:e.signinForm.pass}).then(function(t){e.$message("注册成功"),e.$router.replace("login")}).catch(function(t){e.$message(t.message)})})}}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"signin"},[n("el-card",{staticClass:"signin__signinbox",attrs:{shadow:"hover"}},[n("header",{attrs:{slot:"header"},slot:"header"},[t._v("\n            账号注册\n    ")]),t._v(" "),n("el-form",{ref:"signinForm",staticClass:"signin__signinform",attrs:{model:t.signinForm,"status-icon":"",rules:t.rules}},[n("el-form-item",{attrs:{prop:"username"}},[n("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:t.signinForm.username,callback:function(e){t.$set(t.signinForm,"username",e)},expression:"signinForm.username"}},[n("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("账号")])])],1),t._v(" "),n("el-form-item",{attrs:{prop:"password"}},[n("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:t.signinForm.password,callback:function(e){t.$set(t.signinForm,"password",e)},expression:"signinForm.password"}},[n("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("密码")])])],1),t._v(" "),n("el-form-item",{attrs:{prop:"pass"}},[n("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:t.signinForm.pass,callback:function(e){t.$set(t.signinForm,"pass",e)},expression:"signinForm.pass"}},[n("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("确认")])])],1),t._v(" "),n("el-button",{staticClass:"signin__signinbtn",attrs:{type:"primary"},on:{click:function(e){return t.submitForm("signinForm")}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var p=n("C7Lr")(f,h,!1,function(t){n("k89e")},null,null).exports,g={name:"magix_header",data:function(){return{active:"home",user:this.$store.state.admin.user}},created:function(){},computed:{onRoute:function(){return this.$route.name}},methods:{handleSelect:function(t,e){this.$router.push({name:t})},signout:function(){var t=this;this.$post(u.signout).then(function(e){t.$store.commit("admin/signout")})}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-bar"},[n("el-menu",{staticClass:"el-menu",attrs:{"default-active":t.onRoute,mode:"horizontal","background-color":"#409EFF","text-color":"#fff","active-text-color":"#ff0"},on:{select:t.handleSelect}},[n("el-menu-item",{attrs:{index:"home"}},[t._v("资讯管理")]),t._v(" "),n("el-menu-item",{attrs:{index:"house"}},[t._v("房屋信息")]),t._v(" "),n("el-menu-item",{attrs:{index:"tofix"}},[t._v("用户报修")]),t._v(" "),n("el-menu-item",{attrs:{index:"user_info"}},[t._v("个人信息")]),t._v(" "),"2"!==t.user.type?n("el-menu-item",{attrs:{index:"auth"}},[t._v("用户管理")]):t._e()],1),t._v(" "),n("div",{staticClass:"options"},[n("div",{staticClass:"option-item",on:{click:t.signout}},[t._v("退出")])])],1)},staticRenderFns:[]};var b={name:"home",components:{magixHeader:n("C7Lr")(g,v,!1,function(t){n("qhwM")},null,null).exports},data:function(){return{}},created:function(){},methods:{}},_={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"home"},[e("magix-header"),this._v(" "),e("keep-alive",[this.$route.meta.keepAlive?e("router-view",{staticClass:"fullheight"}):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():e("router-view",{staticClass:"fullheight"})],1)},staticRenderFns:[]};var w=n("C7Lr")(b,_,!1,function(t){n("C2xL")},null,null).exports,x={name:"magix_control",data:function(){return{}},created:function(){},methods:{refresh:function(){location.reload()}}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"magix-control"},[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.$emit("add",e)}}},[t._v("新增")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.refresh}},[t._v("刷新")]),t._v(" "),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){return t.$emit("delete",e)}}},[t._v("删除")])],1)},staticRenderFns:[]};var k=n("C7Lr")(x,y,!1,function(t){n("LSqC")},null,null).exports,$=n("rVsN"),F=n.n($),C={dateFormat:function(t){var e=new Date(t);return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()}},E=C;function L(t){var e=this;return new F.a(function(n,i){e.$get(u.getUser,{params:t}).then(function(t){n(function(t){var e=[];t.users.length>0&&t.users.forEach(function(t,n){e.push({time:E.dateFormat(t.meta.createAt),nickname:t.nickname,phoneNumber:t.phoneNumber,_id:t._id})});return e}(t))}).catch(function(t){i(t)})})}var A={name:"house",components:{magixControl:k},data:function(){return{user:this.$store.state.admin.user,tableData:[],dialogFormVisible:!1,formLabelWidth:"120px",form:{},editorOption:{},gridData:[],dialogTableVisible:!1,check_user:"",length:0}},created:function(){var t=this;this.init({count:10,index:0}),L.bind(this)({type:"2"}).then(function(e){t.gridData=e})},methods:{init:function(t){var e=this;(function(t){var e=this;return new F.a(function(n,i){e.$get(u.getList,{params:t}).then(function(t){n(function(t){var e={house:[],length:0};return t.house.length>0&&(e.length=t.length,t.house.forEach(function(t,n){e.house.push({community:t.community,building:t.building,unit:t.unit,room:t.room,numbered:t.numbered,user:t.user,_id:t._id})})),e}(t))}).catch(function(t){i(t)})})}).bind(this)(t).then(function(t){console.log(t),e.tableData=t.house,e.length=t.length})},initData:function(t){this.form=t?{community:t.community,building:t.building,unit:t.unit,room:t.room,numbered:t.numbered,userId:t.userId}:{community:"",building:"",unit:"",room:"",numbered:"",userId:""}},deleteHouse:function(t){var e=this;console.log(t),this.deleteMsg("此操作将永久删除该文件, 是否继续?").then(function(){(function(t){var e=this;return new F.a(function(n,i){e.$post(u.deleteHouse,t).then(function(t){n(t)}).catch(function(t){i(t)})})}).bind(e)([t._id]).then(function(t){e.$message("删除成功！"),e.init()}).catch(function(t){e.$message(t.message)})})},add:function(){this.initData(),this.dialogFormVisible=!0},submit:function(){var t=this;(function(t){var e=this;return new F.a(function(n,i){e.$post(u.saveHouse,t).then(function(t){n(t)}).catch(function(t){i(t)})})}).bind(this)(this.form).then(function(e){console.log(e),t.$message("保存成功！"),t.dialogFormVisible=!1,t.init(),t.initData()}).catch(function(e){t.$message(e.message)})},showTable:function(){this.dialogTableVisible=!0},checkUser:function(t){this.form.userId=this.check_user,this.dialogTableVisible=!1},getUser:function(t,e){this.check_user=t._id},onEditorBlur:function(t){},onEditorFocus:function(t){},onEditorReady:function(t){},currentChange:function(t){console.log(t),this.init({count:10,index:t-1})}}},S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"house"},[n("magix-control",{on:{add:t.add}}),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:""}},[n("el-table-column",{attrs:{prop:"user.nickname",label:"房主"}}),t._v(" "),n("el-table-column",{attrs:{prop:"community",label:"小区",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"building",label:"栋",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"numbered",label:"加密编号",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"unit",label:"单元",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"room",label:"室",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return t.deleteHouse(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next",total:t.length},on:{"current-change":t.currentChange}}),t._v(" "),n("el-dialog",{attrs:{title:"房屋信息",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("el-form",{attrs:{model:t.form}},[n("el-form-item",{attrs:{label:"小区","label-width":t.formLabelWidth}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.community,callback:function(e){t.$set(t.form,"community",e)},expression:"form.community"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"栋","label-width":t.formLabelWidth}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.building,callback:function(e){t.$set(t.form,"building",e)},expression:"form.building"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"单元","label-width":t.formLabelWidth}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.unit,callback:function(e){t.$set(t.form,"unit",e)},expression:"form.unit"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"室","label-width":t.formLabelWidth}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.room,callback:function(e){t.$set(t.form,"room",e)},expression:"form.room"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"房间码","label-width":t.formLabelWidth}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.numbered,callback:function(e){t.$set(t.form,"numbered",e)},expression:"form.numbered"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"房主","label-width":t.formLabelWidth}},[n("el-input",{attrs:{autocomplete:"off",readonly:""},on:{focus:t.showTable},model:{value:t.form.userId,callback:function(e){t.$set(t.form,"userId",e)},expression:"form.userId"}})],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"收货地址",visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[n("el-table",{attrs:{data:t.gridData,"highlight-current-row":""},on:{"current-change":t.getUser}},[n("el-table-column",{attrs:{property:"time",label:"日期",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{property:"nickname",label:"姓名",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{property:"phoneNumber",label:"电话"}})],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.checkUser}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var D=n("C7Lr")(A,S,!1,function(t){n("FxfD")},null,null).exports,I=n("aA9S"),q=n.n(I),z=["已创建","进行中","已完成"];function T(t){var e=this;return new F.a(function(n,i){e.$get(u.fixList,{params:t}).then(function(t){n(function(t){var e={fix:[],length:0};t.fix.length>0&&(e.length=t.length,t.fix.forEach(function(t,n){console.log(t),e.fix.push({address:t.address,phoneNumber:t.phoneNumber,truble:t.truble,createAt:t.meta.createAt,updateAt:t.meta.updateAt,statu:{value:t.statu,title:z[t.statu]},user:t.user,_id:t._id})}));return e}(t))}).catch(function(t){i(t)})})}var R={name:"tofix",components:{magixControl:k},data:function(){return{tableData:[],length:0,count:10}},created:function(){this.init()},methods:{init:function(t){var e=this;T.bind(this)(q()({},{count:this.count,index:0},t)).then(function(t){e.tableData=t.fix,console.log(e.tableData),e.length=t.length})},deleteFix:function(t){var e=this;console.log(t),this.deleteMsg("此操作将永久删除该文件, 是否继续?").then(function(){(function(t){var e=this;return new F.a(function(n,i){e.$post(u.deleteFix,t).then(function(t){n(t)}).catch(function(t){i(t)})})}).bind(e)([t]).then(function(t){e.init(),e.$message("删除成功！")}).catch(function(t){e.$message(t.message)})})},updateFix:function(t){var e=this;console.log(t),this.$confirm("请确保已指派相关人员上门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(t){var e=this;return new F.a(function(n,i){e.$post(u.saveFix,t).then(function(t){n(t)}).catch(function(t){i(t)})})}).bind(e)({fixId:t,statu:"1"}),e.$message({type:"success",message:"操作成功!"}),e.init()}).catch(function(){e.$message({type:"info",message:"操作取消！"})})},currentChange:function(t){console.log(t),this.init({count:this.count,index:t-1})}}},N={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tofix"},[n("magix-control"),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:""}},[n("el-table-column",{attrs:{prop:"user.nickname",label:"房主"}}),t._v(" "),n("el-table-column",{attrs:{prop:"address",label:"地址"}}),t._v(" "),n("el-table-column",{attrs:{prop:"phoneNumber",label:"联系电话"}}),t._v(" "),n("el-table-column",{attrs:{prop:"truble",label:"问题描述"}}),t._v(" "),n("el-table-column",{attrs:{prop:"statu.title",label:"状态"}}),t._v(" "),n("el-table-column",{attrs:{prop:"createAt",label:"创建时间"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return["0"===e.row.statu.value?n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return t.updateFix(e.row._id)}}},[t._v("审核")]):t._e(),t._v(" "),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return t.deleteFix(e.row._id)}}},[t._v("删除")])]}}])})],1),t._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next",total:t.length},on:{"current-change":t.currentChange}})],1)},staticRenderFns:[]};var M=n("C7Lr")(R,N,!1,function(t){n("Qxxq")},null,null).exports,U=["超级管理员","管理员","用户"],W=["超级管理员","未审核","已审核"];function V(t){var e=this;return new F.a(function(n,i){e.$get(u.getUser,{params:t}).then(function(t){n(function(t){var e={users:[],length:0};t.users.length>0&&(e.length=t.length,t.users.forEach(function(t,n){e.users.push({username:t.username,name:t.nickname,address:t.house&&t.house.address||"-",date:E.dateFormat(t.meta.createAt),_id:t._id,type:{name:U[t.type],value:t.type},statu:{name:W[t.statu],value:t.statu}})}));return e}(t))}).catch(function(t){i(t)})})}var H={name:"auth",components:{magixControl:k},data:function(){return{tableData:[],user:this.$store.state.admin.user,length:0,count:10}},created:function(){this.getList()},methods:{getList:function(t){var e=this,n={count:this.count,index:0};V.bind(this)(q()({},t||n,{type:this.user.type})).then(function(t){e.tableData=t.users,e.length=t.length,console.log(t)})},handleCheck:function(t){var e=this;(function(t){var e=this;return new F.a(function(n,i){e.$post(u.checkUser,{username:t}).then(function(t){n(t)}).catch(function(t){i(t)})})}).bind(this)(t.username).then(function(t){e.getList(),e.$message("审核通过！")})},changeAuth:function(t){var e=this;this.$prompt("请输入权限","修改选线",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/['1','2']/,inputErrorMessage:"权限输入错误"}).then(function(n){var i=n.value;(function(t){var e=this;return new F.a(function(n,i){e.$post(u.changeAuth,t).then(function(t){n(t)}).catch(function(t){i(t)})})}).bind(e)({username:t.username,type:i}).then(function(t){e.getList(),e.$message({type:"success",message:"修改成功"})})}).catch(function(){e.$message({type:"info",message:"取消输入"})})},deleteUser:function(t){var e=this;console.log(t),this.deleteMsg("此操作将永久删除该文件, 是否继续?").then(function(){(function(t){var e=this;return new F.a(function(n,i){e.$post(u.deleteUser,t).then(function(t){n(t)}).catch(function(t){i(t)})})}).bind(e)([t]).then(function(t){e.$message("删除成功！"),e.getList()}).catch(function(t){e.$message(t.message)})})},currentChange:function(t){this.getList({count:this.count,index:t-1})}}},B={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"auth"},[n("magix-control"),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:""}},[n("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"type.name",label:"类别",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"statu.name",label:"审核",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"date",label:"日期",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"address",label:"地址"}}),t._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"===e.row.statu.value?n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return t.handleCheck(e.row)}}},[t._v("审核")]):t._e(),t._v(" "),"admin"===t.user.username?n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return t.changeAuth(e.row)}}},[t._v("权限")]):t._e(),t._v(" "),"admin"===t.user.username?n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return t.deleteUser(e.row._id)}}},[t._v("删除")]):t._e()]}}])})],1),t._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next",total:t.length},on:{"current-change":t.currentChange}})],1)},staticRenderFns:[]};var O=n("C7Lr")(H,B,!1,function(t){n("jT0q")},null,null).exports,P={name:"magix_aside",data:function(){return{isCollapse:!1}},created:function(){},computed:{onRoute:function(){return this.$route.name}},methods:{handleSelect:function(t,e){this.$router.push(t)},handleOpen:function(t,e){console.log(t,e)},handleClose:function(t,e){console.log(t,e)}}},j={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"magix-aside"},[n("el-menu",{staticClass:"el-menu-vertical",attrs:{"default-active":t.onRoute,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",collapse:t.isCollapse},on:{open:t.handleOpen,close:t.handleClose,select:t.handleSelect}},[n("el-menu-item",{attrs:{index:"user_info"}},[n("i",{staticClass:"el-icon-document"}),t._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[t._v("个人信息")])]),t._v(" "),n("el-menu-item",{attrs:{index:"reset_password"}},[n("i",{staticClass:"el-icon-setting"}),t._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[t._v("修改密码")])])],1)],1)},staticRenderFns:[]};var Z=n("C7Lr")(P,j,!1,function(t){n("5gk/")},null,null).exports,J={name:"user",components:{magixAside:Z},data:function(){return{}},created:function(){},methods:{}},Q={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"user"},[e("magix-aside",{staticClass:"aside"}),this._v(" "),e("keep-alive",[this.$route.meta.keepAlive?e("router-view",{staticClass:"content"}):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():e("router-view",{staticClass:"content"})],1)},staticRenderFns:[]};var G=n("C7Lr")(J,Q,!1,function(t){n("6WFI")},null,null).exports,Y={name:"user_info",data:function(){return{form:{},ADMIN_TYPE:U,user:this.$store.state.admin.user}},created:function(){this.form={username:this.user.username,nickname:this.user.nickname,password:this.user.password,carNum:this.user.car&&this.user.car.carNumber||"",address:this.user.house&&this.user.house.address||"",type:this.user.type}},methods:{update:function(){var t=this;this.$confirm("所有修改将保存, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(t){var e=this;return new F.a(function(n,i){e.$post(u.update,t).then(function(t){n(t)}).catch(function(t){i(t)})})}).bind(t)({username:t.user.username,nickname:t.form.nickname,car:{carNumber:t.form.carNum},house:{address:t.form.address}}).then(function(e){t.$store.commit("admin/updateUser",e.user),t.$message("保存成功")})}).catch(function(){t.$message({type:"info",message:"已取消更改"})})}}},X={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-info"},[n("el-card",{staticClass:"box-card"},[n("el-form",{ref:"form",staticClass:"userform",attrs:{model:t.form,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"用户名："}},[n("span",[t._v(t._s(t.form.username))])]),t._v(" "),n("el-form-item",{attrs:{label:"昵称："}},[n("el-input",{model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"权限："}},[n("span",[t._v(t._s(t.ADMIN_TYPE[t.form.type]))])]),t._v(" "),n("div",{staticClass:"save-btn"},[n("el-button",{attrs:{type:"primary"},on:{click:t.update}},[t._v("保存")])],1)],1)],1)],1)},staticRenderFns:[]};var K=n("C7Lr")(Y,X,!1,function(t){n("qMsW")},null,null).exports,tt={name:"reset_password",components:{magixAside:Z},data:function(){return{user:this.$store.state.admin.user,form:{old_pass:"",new_pass:"",new_repass:""}}},created:function(){},methods:{save:function(){var t=this;(function(t){var e=this;return new F.a(function(n,i){e.$post(u.resetPassword,t).then(function(t){n(t)}).catch(function(t){i(t)})})}).bind(this)(q()({},this.form,{username:this.user.username})).then(function(e){t.$message("修改成功,请重新登录！"),t.$store.commit("admin/signout")}).catch(function(t){})}}},et={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"reset-password"},[n("el-card",{staticClass:"box-card"},[n("el-form",{ref:"form",staticClass:"userform",attrs:{model:t.form,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"旧密码："}},[n("el-input",{model:{value:t.form.old_pass,callback:function(e){t.$set(t.form,"old_pass",e)},expression:"form.old_pass"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"新密码："}},[n("el-input",{model:{value:t.form.new_pass,callback:function(e){t.$set(t.form,"new_pass",e)},expression:"form.new_pass"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"确认密码："}},[n("el-input",{model:{value:t.form.new_repass,callback:function(e){t.$set(t.form,"new_repass",e)},expression:"form.new_repass"}})],1),t._v(" "),n("div",{staticClass:"save-btn"},[n("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)],1)},staticRenderFns:[]};var nt=n("C7Lr")(tt,et,!1,function(t){n("l42e")},null,null).exports;function it(t){var e=this;return new F.a(function(n,i){e.$get(u.searchNews,{params:t}).then(function(t){n(t)}).catch(function(t){i(t)})})}var ot=n("aiqZ"),at=n("AA3o"),st=n.n(at),rt=n("xSur"),lt=n.n(rt),ut={watcher:{},active:null,on:function(t,e){this.watcher[t]||(this.watcher[t]=e)},emit:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.active=this.watcher[t],1===e&&function(){var t=document.querySelector(".quill-image-input");null===t&&((t=document.createElement("input")).setAttribute("type","file"),t.classList.add("quill-image-input"),t.style.display="none",t.addEventListener("change",function(){var e=ut.active;e.file=t.files[0],t.value="",e.config.size&&e.file.size>=1024*e.config.size*1024?e.config.sizeError&&e.config.sizeError():e.config.action?e.uploadImg():e.toBase64()}),document.body.appendChild(t));t.click()}()}},ct=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};st()(this,t),this.id=Math.random(),this.quill=e,this.quill.id=this.id,this.config=n,this.file="",this.imgURL="",e.root.addEventListener("paste",this.pasteHandle.bind(this),!1),e.root.addEventListener("drop",this.dropHandle.bind(this),!1),e.root.addEventListener("dropover",function(t){t.preventDefault()},!1),this.cursorIndex=0,ut.on(this.id,this)}return lt()(t,[{key:"pasteHandle",value:function(t){ut.emit(this.quill.id,0);var e=t.clipboardData,n=0,i=void 0,o=void 0,a=void 0;if(e){if(!(i=e.items))return;for(o=i[0],a=e.types||[];n<a.length;n++)if("Files"===a[n]){o=i[n];break}if(o&&"file"===o.kind&&o.type.match(/^image\//i)){this.file=o.getAsFile();if(this.config.size&&this.file.size>=1024*this.config.size*1024)return void(this.config.sizeError&&this.config.sizeError());this.config.action}}}},{key:"dropHandle",value:function(t){ut.emit(this.quill.id,0);t.preventDefault(),this.config.size&&this.file.size>=1024*this.config.size*1024?this.config.sizeError&&this.config.sizeError():(this.file=t.dataTransfer.files[0],this.config.action?this.uploadImg():this.toBase64())}},{key:"toBase64",value:function(){var t=this,e=new FileReader;e.onload=function(e){t.imgURL=e.target.result,t.insertImg()},e.readAsDataURL(t.file)}},{key:"uploadImg",value:function(){var t=this,e=(t.quillLoading,t.config),n=new FormData;n.append(e.name,t.file),e.editForm&&e.editForm(n);var i=new XMLHttpRequest;i.open("post",e.action,!0),e.headers&&e.headers(i),e.change&&e.change(i,n),i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var n=JSON.parse(i.responseText);t.imgURL=e.response(n),ut.active.uploadSuccess(),t.insertImg(),t.config.success&&t.config.success()}else t.config.error&&t.config.error(),ut.active.uploadError()},i.upload.onloadstart=function(t){ut.active.uploading(),e.start&&e.start()},i.upload.onprogress=function(t){var e=(t.loaded/t.total*100|0)+"%";ut.active.progress(e)},i.upload.onerror=function(t){ut.active.uploadError(),e.error&&e.error()},i.upload.onloadend=function(t){e.end&&e.end()},i.send(n)}},{key:"insertImg",value:function(){var t=ut.active;t.quill.insertEmbed(ut.active.cursorIndex,"image",t.imgURL),t.quill.update(),t.quill.setSelection(t.cursorIndex+1)}},{key:"progress",value:function(t){t="[uploading"+t+"]",ut.active.quill.root.innerHTML=ut.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,t)}},{key:"uploading",value:function(){var t=(ut.active.quill.getSelection()||{}).index||ut.active.quill.getLength();ut.active.cursorIndex=t,ut.active.quill.insertText(ut.active.cursorIndex,"[uploading...]",{color:"red"},!0)}},{key:"uploadError",value:function(){ut.active.quill.root.innerHTML=ut.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"[upload error]")}},{key:"uploadSuccess",value:function(){ut.active.quill.root.innerHTML=ut.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"")}}]),t}();var mt=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]];ot.Quill.register("modules/ImageExtend",ct);var dt={name:"news",components:{magixControl:k,quillEditor:ot.quillEditor},filters:{dateFormat:function(t){return E.dateFormat(t)}},data:function(){return{user:this.$store.state.admin.user,news:[],length:0,dialogFormVisible:!1,formLabelWidth:"120px",form:{},editorOption:{modules:{ImageExtend:{loading:!0,name:"img",action:u.upload,response:function(t){return t.data}},toolbar:{container:mt,handlers:{image:function(){ut.emit(this.quill.id)}}}}}}},mounted:function(){var t=this;it.bind(this)({count:10,index:0}).then(function(e){console.log(t),t.news=e.news.slice(0,10),t.length=e.length},function(t){console.log(t)})},methods:{initData:function(t){this.form=t?{title:t.title,type:t.type,sub:t.sub,content:t.content,images:t.images,_id:t._id}:{title:"",type:"",sub:"",content:"",images:"",_id:""}},add:function(){this.initData(),this.dialogFormVisible=!0},openDetail:function(t){this.initData(t),this.dialogFormVisible=!0},onEditorBlur:function(t){},onEditorFocus:function(t){},onEditorReady:function(t){},submit:function(){this.dialogFormVisible=!1,function(t){var e=this;return new F.a(function(n,i){e.$post(u.saveNews,t).then(function(t){n(t)}).catch(function(t){i(t)})})}.bind(this)({title:this.form.title,sub:this.form.sub,images:this.form.images,content:this.form.content,type:this.form.type,userId:this.user._id,_id:this.form._id}).then(function(t){})},deleteNews:function(t){var e=this;console.log(t),this.deleteMsg("此操作将永久删除该文件, 是否继续?").then(function(){(function(t){var e=this;return new F.a(function(n,i){e.$post(u.deleteNews,t).then(function(t){n(t)}).catch(function(t){i(t)})})}).bind(e)({_id:t._id}).then(function(t){e.$message({type:"success",message:"删除成功!"})})})},getList:function(t){var e=this;it.bind(this)({count:10,index:t-1}).then(function(t){e.news=t.news.slice(0,10)})},currentChange:function(t){console.log(t),this.getList(t)}}},ft={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"news"},[n("magix-control",{on:{add:t.add}}),t._v(" "),n("div",{staticClass:"container"},[t._l(t.news,function(e,i){return n("el-card",{key:i,staticClass:"box-card",nativeOn:{click:function(n){return t.openDetail(e)}}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",{staticClass:"title"},[t._v(t._s(e.title))])]),t._v(" "),n("div",{staticClass:"box-content"},[n("p",{staticClass:"sub"},[t._v(t._s(e.sub))]),t._v(" "),n("div",{staticClass:"foot"},[n("span",{staticClass:"author"},[t._v(t._s(e.user&&e.user.nickname))]),t._v(" "),n("time",{staticClass:"time"},[t._v(t._s(t._f("dateFormat")(e.meta.updateAt)))])])]),t._v(" "),n("i",{staticClass:"el-icon-error delete",on:{click:function(n){return n.stopPropagation(),t.deleteNews(e)}}})])}),t._v(" "),0===t.news.length?n("div",{staticClass:"empty"},[t._v("暂无数据")]):t._e()],2),t._v(" "),n("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next",total:t.length},on:{"current-change":t.currentChange}}),t._v(" "),n("el-dialog",{attrs:{title:"小区资讯",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("el-form",{attrs:{model:t.form}},[n("el-form-item",{attrs:{label:"资讯标题","label-width":t.formLabelWidth}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"资讯类型","label-width":t.formLabelWidth}},[n("el-select",{attrs:{placeholder:"请选择资讯类型"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[n("el-option",{attrs:{label:"租赁",value:"1"}}),t._v(" "),n("el-option",{attrs:{label:"新鲜事",value:"2"}})],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"副标题","label-width":t.formLabelWidth}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.sub,callback:function(e){t.$set(t.form,"sub",e)},expression:"form.sub"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"正文","label-width":t.formLabelWidth}},[n("quill-editor",{ref:"myQuillEditor",staticClass:"editor",attrs:{options:t.editorOption},on:{blur:function(e){return t.onEditorBlur(e)},focus:function(e){return t.onEditorFocus(e)},ready:function(e){return t.onEditorReady(e)}},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var ht=n("C7Lr")(dt,ft,!1,function(t){n("lNBI")},null,null).exports;a.default.use(l.a);var pt=new l.a({routes:[{path:"*",redirect:"/home"},{path:"/login",name:"login",component:d,meta:{auth:!1,keepAlive:!1}},{path:"/signin",name:"signin",component:p,meta:{auth:!1,keepAlive:!1}},{path:"/",component:w,redirect:"/home",meta:{auth:!0,keepAlive:!1},children:[{path:"/home",name:"home",component:ht,meta:{auth:!0,keepAlive:!1}},{path:"/house",name:"house",component:D,meta:{auth:!0,keepAlive:!1}},{path:"/tofix",name:"tofix",component:M,meta:{auth:!0,keepAlive:!1}},{path:"/auth",name:"auth",component:O,meta:{auth:!0,keepAlive:!1}},{path:"/user",name:"user",component:G,meta:{auth:!0,keepAlive:!1},children:[{path:"/user/user_info",name:"user_info",component:K,meta:{auth:!0,keepAlive:!1}},{path:"/user/reset_password",name:"reset_password",component:nt,meta:{auth:!0,keepAlive:!1}}]}]}]});pt.beforeEach(function(t,e,n){t.meta.auth?window.localStorage.getItem("token")?n():n("login"):n()});var gt=pt,vt=(n("lBgt"),n("xsZ7"),n("4f9f"),n("lMgl"),n("D9hl"),n("3ntp"),n("FhoZ"),n("aozt")),bt=n.n(vt),_t={900:"后台错误",500:"请输入检索内容"},wt=n("R4Sj"),xt=n("3cXf"),yt=n.n(xt),kt={namespaced:!0,state:{token:localStorage.getItem("token"),user:JSON.parse(window.localStorage.getItem("user"))},mutations:{updateUser:function(t,e){window.localStorage.setItem("user",yt()(e)),t.user=JSON.parse(window.localStorage.getItem("user"))},signout:function(t){gt.replace("/login"),t.token=null,t.user=null,window.localStorage.removeItem("token"),window.localStorage.removeItem("user")}}};a.default.use(wt.a);var $t=new wt.a.Store({modules:{admin:kt}});a.default.$axios=a.default.prototype.$axios=bt.a,a.default.$axios.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",bt.a.interceptors.request.use(function(t){return localStorage.getItem("token")&&(t.headers.Authorization="token "+localStorage.getItem("token")),t},function(t){return F.a.reject(t)}),bt.a.interceptors.response.use(function(t){return 10010===t.data.code||10011===t.data.code?(localStorage.removeItem("token"),router.replace({path:"/login"})):t.data.token&&localStorage.setItem("token",t.data.token),t},function(t){return F.a.reject(t)}),a.default.$get=a.default.prototype.$get=function(t,e){return new F.a(function(n,i){a.default.$axios.get(t,e).then(function(t){200===t.data.code?n(t.data.data):i({code:t.data.code,message:_t[t.data.code]||t.data.message})})})},a.default.$post=a.default.prototype.$post=function(t,e){return new F.a(function(n,i){a.default.$axios.post(t,e).then(function(t){200===t.data.code?n(t.data.data):i({code:t.data.code,message:_t[t.data.code]||t.data.message})})})},a.default.mixin({methods:{addPath:function(t){return console.log("localhost:3000"+t),"http://192.168.200.70:3000"+t}}}),a.default.mixin({methods:{deleteMsg:function(t){var e=this;return new F.a(function(n,i){e.$confirm(t,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n()}).catch(function(){e.$message({type:"info",message:"已取消删除"})})})}}}),a.default.use(o.a),a.default.config.productionTip=!1,a.default.mixin({methods:{cw:function(){return window.innerWidth}}}),a.default.directive("title",{componentUpdated:function(t,e){document.title=e.value}}),new a.default({el:"#app",router:gt,store:$t,components:{App:r},template:"<App/>",data:function(){return{screenWidth:document.body.clientWidth,timer:!1}},watch:{screenWidth:function(t){if(!this.timer){this.screenWidth=t,this.timer=!0;var e=this;setTimeout(function(){e.timer=!1},400)}}},mounted:function(){var t=this;window.onresize=function(){t.screenWidth=document.body.clientWidth}}})},Qxxq:function(t,e){},ayj4:function(t,e){},jT0q:function(t,e){},k89e:function(t,e){},l42e:function(t,e){},lBgt:function(t,e){},lMgl:function(t,e){},lNBI:function(t,e){},qMsW:function(t,e){},qhwM:function(t,e){},xsZ7:function(t,e){}},[0]);
//# sourceMappingURL=main.01a69f9099f3c9ee6619.js.map